import{r as E,d as S,c as U,o as b,w as d,b as i,u as o,g as y,n as j,a as n,e as G,f as M,t as C}from"./app-CZoUp2vn.js";import{_ as N}from"./ActionMessage-Cn0zeNe6.js";import{_ as F}from"./FormSection-DdlWSAax.js";import{_ as p}from"./InputError-CY-tt7lq.js";import{_}from"./InputLabel-HP-SjKYk.js";import{_ as R}from"./PrimaryButton-Cukri6w9.js";import{_ as f}from"./TextInput-CwbL4Esz.js";import{_ as z}from"./InputRadio-Cw6KMbbN.js";import{E as T}from"./Alerts-CzfkhLAa.js";import{a as Z}from"./Utils-sBlKm8uS.js";import{G as q,C as D,M as x}from"./CurrenciesService-kQ6e9vEw.js";import"./SectionTitle-Dc0__E7P.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./sweetalert2.all-_dHarIAb.js";const I=t=>{if(!t||t.length==0)return console.log("no prices"),!1;const s={cancun:[],rm:[],pdc:[]};return t.forEach(c=>{c.zone_id==1?s.cancun=[...s.cancun,c]:c.zone_id==2?s.rm=[...s.rm,c]:c.zone_id==3&&(s.pdc=[...s.pdc,c])}),s},m={GetCurrencyByCode:q,MultiplyCurrency:x,CalculateCurrencyConversion:D,ApplyConversionRate:(t,s)=>x(t,s).toFixed(2)},O={class:"col-span-6 sm:col-span-4"},L={class:"flex gap-4"},H={class:"flex items-center pl-4"},J={class:"flex items-center pl-4"},K={class:"flex items-center pl-4"},Q={class:"col-span-6 sm:col-span-4"},W={key:0,class:"mt-1 font-bold text-sm text-gray-500"},X={class:"col-span-6 sm:col-span-4"},Y={class:"col-span-6 sm:col-span-4"},ee={class:"col-span-6 sm:col-span-4"},ge={__name:"AddPricesForm",props:{activity:Object},setup(t){const s=t,c={adult_low_price:"0.00",kid_low_price:"0.00",adult_high_price:"0.00",kid_high_price:"0.00"},v=E(null),B=l=>{let r={};return l.forEach(a=>{r[a.type]||(r[a.type]={}),r[a.type][a.season]||(r[a.type][a.season]={}),r[a.type][a.season]=a.amount}),{adult_low_price:r.adult.low,kid_low_price:r.kid.low,adult_high_price:r.adult.high,kid_high_price:r.kid.high}},h=l=>{var a;let r=I(s.activity.prices);return r&&((a=r[l])==null?void 0:a.length)>0?B(r[l]):c},e=S.useForm({price_zone:"cancun",cancun:{...h("cancun")},rm:{...h("rm")},pdc:{...h("pdc")},model:[]}),$=()=>{e.post(route("activity.price.upsert"),{preserveScroll:!0,onSuccess:l=>{console.log(l)},onError:l=>{console.log(l),T("Error inesperado","Verifique los datos ingresados")}})},g=(l,r=null,a,k,w)=>{const V=Z(a),P=e.model.find(u=>u.zone_id===V&&u.season===k&&u.type===w);if(P){P.amount=l;return}else{const u={activity_id:r,zone_id:V,season:k,type:w,amount:l};e.model.push(u);return}},A=async()=>{const l=await m.GetCurrencyByCode("USD");v.value=l.data.currency;const r={adult_low_price:m.CalculateCurrencyConversion(e[e.price_zone].adult_low_price,l.data.currency.conversion_rate),kid_low_price:m.CalculateCurrencyConversion(e[e.price_zone].kid_low_price,l.data.currency.conversion_rate),adult_high_price:m.CalculateCurrencyConversion(e[e.price_zone].adult_high_price,l.data.currency.conversion_rate),kid_high_price:m.CalculateCurrencyConversion(e[e.price_zone].kid_high_price,l.data.currency.conversion_rate)};e.getConvertedPrcies=r,console.log(e.getConvertedPrcies)};return(l,r)=>(b(),U(F,{onSubmitted:$},{title:d(()=>[y(" Agregar precios ")]),description:d(()=>[y(" Agregue los precios por temporada Alta y Baja para Adultos y Menores para la actividad. "),n("button",{type:"button",onClick:A},"Llamar API")]),form:d(()=>[n("div",O,[i(_,{for:"price_zone",value:"Zona"}),n("div",L,[n("div",H,[i(z,{label:"Cancun",name:"price_zone",modelValue:o(e).price_zone,"onUpdate:modelValue":r[0]||(r[0]=a=>o(e).price_zone=a),value:"cancun",id:"cancun"},null,8,["modelValue"])]),n("div",J,[i(z,{label:"Riviera Maya",name:"price_zone",modelValue:o(e).price_zone,"onUpdate:modelValue":r[1]||(r[1]=a=>o(e).price_zone=a),value:"rm",id:"rm"},null,8,["modelValue"])]),n("div",K,[i(z,{label:"Playa del Carmen",name:"price_zone",modelValue:o(e).price_zone,"onUpdate:modelValue":r[2]||(r[2]=a=>o(e).price_zone=a),value:"pdc",id:"pdc"},null,8,["modelValue"])])]),i(p,{message:o(e).errors.activity_type,class:"mt-2"},null,8,["message"])]),n("div",Q,[i(_,{for:"adult_low_price",value:"Precio adulto ( temporada baja )"}),i(f,{id:"adult_low_price",onChange:r[3]||(r[3]=a=>g(o(e)[o(e).price_zone].adult_low_price,t.activity.id,o(e).price_zone,"low","adult")),modelValue:o(e)[o(e).price_zone].adult_low_price,"onUpdate:modelValue":r[4]||(r[4]=a=>o(e)[o(e).price_zone].adult_low_price=a),pattern:"[0-9]+([,\\.][0-9]+)?",type:"text",class:"mt-1 block w-full"},null,8,["modelValue"]),o(e).getConvertedPrcies?(b(),G("span",W,C(v.value.code)+" "+C(v.value.symbol)+C(o(e).getConvertedPrcies.adult_low_price),1)):M("",!0),i(p,{message:o(e).errors.adult_low_price,class:"mt-2"},null,8,["message"])]),n("div",X,[i(_,{for:"kid_low_price",value:"Precio menor ( temporada baja )"}),i(f,{onChange:r[5]||(r[5]=a=>g(o(e)[o(e).price_zone].kid_low_price,t.activity.id,o(e).price_zone,"low","kid")),id:"kid_low_price",modelValue:o(e)[o(e).price_zone].kid_low_price,"onUpdate:modelValue":r[6]||(r[6]=a=>o(e)[o(e).price_zone].kid_low_price=a),type:"text",class:"mt-1 block w-full"},null,8,["modelValue"]),i(p,{message:o(e).errors.kid_low_price,class:"mt-2"},null,8,["message"])]),n("div",Y,[i(_,{for:"adult_high_price",value:"Precio adulto ( temporada alta )"}),i(f,{onChange:r[7]||(r[7]=a=>g(o(e)[o(e).price_zone].adult_high_price,t.activity.id,o(e).price_zone,"high","adult")),id:"adult_high_price",modelValue:o(e)[o(e).price_zone].adult_high_price,"onUpdate:modelValue":r[8]||(r[8]=a=>o(e)[o(e).price_zone].adult_high_price=a),type:"text",class:"mt-1 block w-full"},null,8,["modelValue"]),i(p,{message:o(e).errors.adult_high_price,class:"mt-2"},null,8,["message"])]),n("div",ee,[i(_,{for:"kid_high_price",value:"Precio menor ( temporada alta )"}),i(f,{onChange:r[9]||(r[9]=a=>g(o(e)[o(e).price_zone].kid_high_price,t.activity.id,o(e).price_zone,"high","kid")),id:"kid_high_price",modelValue:o(e)[o(e).price_zone].kid_high_price,"onUpdate:modelValue":r[10]||(r[10]=a=>o(e)[o(e).price_zone].kid_high_price=a),type:"text",class:"mt-1 block w-full"},null,8,["modelValue"]),i(p,{message:o(e).errors.kid_high_price,class:"mt-2"},null,8,["message"])])]),actions:d(()=>[i(N,{on:o(e).recentlySuccessful,class:"mr-3"},{default:d(()=>[y(" Precios guardados. ")]),_:1},8,["on"]),i(R,{class:j({"opacity-25":o(e).processing}),disabled:o(e).processing},{default:d(()=>[y(" Guardar ")]),_:1},8,["class","disabled"])]),_:1}))}};export{ge as default};
