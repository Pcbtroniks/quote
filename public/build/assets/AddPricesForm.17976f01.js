import{r as E,u as S,c as U,w as d,o as P,f as y,a as n,b as l,g as o,d as F,t as z,e as N,n as j}from"./app.a9d6c151.js";import{_ as G}from"./ActionMessage.a0230938.js";import{_ as M}from"./FormSection.e9f3bd9f.js";import{_ as p}from"./InputError.9cd604e2.js";import{_}from"./InputLabel.63dfaa8c.js";import{_ as T}from"./PrimaryButton.bb5e0fe8.js";import{_ as f}from"./TextInput.38cfc188.js";import{_ as C}from"./InputRadio.2b88f109.js";import{E as Z}from"./Alerts.455b1b2d.js";import{a as q}from"./Utils.91184964.js";import"./SectionTitle.8a1b47fd.js";import"./_plugin-vue_export-helper.cdc0426e.js";import"./sweetalert2.all.f7c5ae7a.js";const D=i=>{if(!i||i.length==0)return console.log("no prices"),!1;const s={cancun:[],rm:[],pdc:[]};return i.forEach(c=>{c.zone_id==1?s.cancun=[...s.cancun,c]:c.zone_id==2?s.rm=[...s.rm,c]:c.zone_id==3&&(s.pdc=[...s.pdc,c])}),s},I=async i=>await axios.get(route("localisation.currencies.api.get",{currency:i})),O=(i,s)=>(i=Number.parseFloat(i),s=Number.parseFloat(s),Number.parseFloat(i*s).toFixed(2)),x=(i,s)=>i*s,m={GetCurrencyByCode:I,MultiplyCurrency:x,CalculateCurrencyConversion:O,ApplyConversionRate:(i,s)=>x(i,s).toFixed(2)},L={class:"col-span-6 sm:col-span-4"},R={class:"flex gap-4"},H={class:"flex items-center pl-4"},J={class:"flex items-center pl-4"},K={class:"flex items-center pl-4"},Q={class:"col-span-6 sm:col-span-4"},W={key:0,class:"mt-1 font-bold text-sm text-gray-500"},X={class:"col-span-6 sm:col-span-4"},Y={class:"col-span-6 sm:col-span-4"},ee={class:"col-span-6 sm:col-span-4"},me={__name:"AddPricesForm",props:{activity:Object},setup(i){const s=i,c={adult_low_price:"0.00",kid_low_price:"0.00",adult_high_price:"0.00",kid_high_price:"0.00"},v=E(null),B=t=>{let r={};return t.forEach(a=>{r[a.type]||(r[a.type]={}),r[a.type][a.season]||(r[a.type][a.season]={}),r[a.type][a.season]=a.amount}),{adult_low_price:r.adult.low,kid_low_price:r.kid.low,adult_high_price:r.adult.high,kid_high_price:r.kid.high}},h=t=>{var a;let r=D(s.activity.prices);return r&&((a=r[t])==null?void 0:a.length)>0?B(r[t]):c},e=S({price_zone:"cancun",cancun:{...h("cancun")},rm:{...h("rm")},pdc:{...h("pdc")},model:[]}),$=()=>{e.post(route("activity.price.upsert"),{preserveScroll:!0,onSuccess:t=>{console.log(t)},onError:t=>{console.log(t),Z("Error inesperado","Verifique los datos ingresados")}})},g=(t,r=null,a,k,w)=>{const V=q(a),b=e.model.find(u=>u.zone_id===V&&u.season===k&&u.type===w);if(b){b.amount=t;return}else{const u={activity_id:r,zone_id:V,season:k,type:w,amount:t};e.model.push(u);return}},A=async()=>{const t=await m.GetCurrencyByCode("USD");v.value=t.data.currency;const r={adult_low_price:m.CalculateCurrencyConversion(e[e.price_zone].adult_low_price,t.data.currency.conversion_rate),kid_low_price:m.CalculateCurrencyConversion(e[e.price_zone].kid_low_price,t.data.currency.conversion_rate),adult_high_price:m.CalculateCurrencyConversion(e[e.price_zone].adult_high_price,t.data.currency.conversion_rate),kid_high_price:m.CalculateCurrencyConversion(e[e.price_zone].kid_high_price,t.data.currency.conversion_rate)};e.getConvertedPrcies=r,console.log(e.getConvertedPrcies)};return(t,r)=>(P(),U(M,{onSubmitted:$},{title:d(()=>[y(" Agregar precios ")]),description:d(()=>[y(" Agregue los precios por temporada Alta y Baja para Adultos y Menores para la actividad. "),n("button",{type:"button",onClick:A},"Llamar API")]),form:d(()=>[n("div",L,[l(_,{for:"price_zone",value:"Zona"}),n("div",R,[n("div",H,[l(C,{label:"Cancun",name:"price_zone",modelValue:o(e).price_zone,"onUpdate:modelValue":r[0]||(r[0]=a=>o(e).price_zone=a),value:"cancun",id:"cancun"},null,8,["modelValue"])]),n("div",J,[l(C,{label:"Riviera Maya",name:"price_zone",modelValue:o(e).price_zone,"onUpdate:modelValue":r[1]||(r[1]=a=>o(e).price_zone=a),value:"rm",id:"rm"},null,8,["modelValue"])]),n("div",K,[l(C,{label:"Playa del Carmen",name:"price_zone",modelValue:o(e).price_zone,"onUpdate:modelValue":r[2]||(r[2]=a=>o(e).price_zone=a),value:"pdc",id:"pdc"},null,8,["modelValue"])])]),l(p,{message:o(e).errors.activity_type,class:"mt-2"},null,8,["message"])]),n("div",Q,[l(_,{for:"adult_low_price",value:"Precio adulto ( temporada baja )"}),l(f,{id:"adult_low_price",onChange:r[3]||(r[3]=a=>g(o(e)[o(e).price_zone].adult_low_price,i.activity.id,o(e).price_zone,"low","adult")),modelValue:o(e)[o(e).price_zone].adult_low_price,"onUpdate:modelValue":r[4]||(r[4]=a=>o(e)[o(e).price_zone].adult_low_price=a),pattern:"[0-9]+([,\\.][0-9]+)?",type:"text",class:"mt-1 block w-full"},null,8,["modelValue"]),o(e).getConvertedPrcies?(P(),F("span",W,z(v.value.code)+" "+z(v.value.symbol)+z(o(e).getConvertedPrcies.adult_low_price),1)):N("",!0),l(p,{message:o(e).errors.adult_low_price,class:"mt-2"},null,8,["message"])]),n("div",X,[l(_,{for:"kid_low_price",value:"Precio menor ( temporada baja )"}),l(f,{onChange:r[5]||(r[5]=a=>g(o(e)[o(e).price_zone].kid_low_price,i.activity.id,o(e).price_zone,"low","kid")),id:"kid_low_price",modelValue:o(e)[o(e).price_zone].kid_low_price,"onUpdate:modelValue":r[6]||(r[6]=a=>o(e)[o(e).price_zone].kid_low_price=a),type:"text",class:"mt-1 block w-full"},null,8,["modelValue"]),l(p,{message:o(e).errors.kid_low_price,class:"mt-2"},null,8,["message"])]),n("div",Y,[l(_,{for:"adult_high_price",value:"Precio adulto ( temporada alta )"}),l(f,{onChange:r[7]||(r[7]=a=>g(o(e)[o(e).price_zone].adult_high_price,i.activity.id,o(e).price_zone,"high","adult")),id:"adult_high_price",modelValue:o(e)[o(e).price_zone].adult_high_price,"onUpdate:modelValue":r[8]||(r[8]=a=>o(e)[o(e).price_zone].adult_high_price=a),type:"text",class:"mt-1 block w-full"},null,8,["modelValue"]),l(p,{message:o(e).errors.adult_high_price,class:"mt-2"},null,8,["message"])]),n("div",ee,[l(_,{for:"kid_high_price",value:"Precio menor ( temporada alta )"}),l(f,{onChange:r[9]||(r[9]=a=>g(o(e)[o(e).price_zone].kid_high_price,i.activity.id,o(e).price_zone,"high","kid")),id:"kid_high_price",modelValue:o(e)[o(e).price_zone].kid_high_price,"onUpdate:modelValue":r[10]||(r[10]=a=>o(e)[o(e).price_zone].kid_high_price=a),type:"text",class:"mt-1 block w-full"},null,8,["modelValue"]),l(p,{message:o(e).errors.kid_high_price,class:"mt-2"},null,8,["message"])])]),actions:d(()=>[l(G,{on:o(e).recentlySuccessful,class:"mr-3"},{default:d(()=>[y(" Precios guardados. ")]),_:1},8,["on"]),l(T,{class:j({"opacity-25":o(e).processing}),disabled:o(e).processing},{default:d(()=>[y(" Guardar ")]),_:1},8,["class","disabled"])]),_:1}))}};export{me as default};
