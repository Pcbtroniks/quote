import{d as g,r as h,e as u,o as c,f as U,a as n,b as o,w as t,F as B,h as C,t as k,g as l,u as m,n as b}from"./app-BDCeMI-n.js";import{_ as E}from"./ActionSection-BprqMCHs.js";import{_ as N}from"./Checkbox-lm0CQMln.js";import{_ as V}from"./ConfirmationModal-BgZqX9EA.js";import{_ as D}from"./DangerButton-CuAqPpqr.js";import{_ as T}from"./DialogModal-Dkbead_2.js";import{_ as A}from"./PrimaryButton-B3QQMSTm.js";import{_ as x}from"./SecondaryButton-DvdaEhY4.js";import{S as G}from"./SectionBorder-B8i_5c61.js";import"./SectionTitle-B0L66kJy.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Modal-BMe6YGMT.js";const M=Swal.mixin({toast:!0,position:"top-right",iconColor:"white",customClass:{popup:"colored-toast"},showConfirmButton:!1,timer:1500,timerProgressBar:!0}),P=(_="Success")=>M.fire({icon:"success",title:_}),j={key:0},q={class:"mt-10 sm:mt-0"},z={class:"space-y-6"},H={class:"flex items-center"},L=["onClick"],I=["onClick"],J={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},K={class:"flex items-center"},O={class:"ml-2 text-sm text-gray-600"},oe={__name:"BranchUserManager",props:{branches:Array,users:Array},setup(_){const f=_,s=g.useForm({users:null,updateUsers:[],usersBeingUpdated:[]}),v=g.useForm(),i=h(null),d=h(null),y=r=>{i.value=r,s.users=f.users.filter(e=>e.branch_id==r.id).map(e=>e.id)},$=r=>{if(s.updateUsers.includes(r))s.updateUsers=s.updateUsers.filter(e=>e!=r),s.usersBeingUpdated=s.usersBeingUpdated.filter(e=>e.user_id!=r);else{s.updateUsers=[...s.updateUsers,r];const e=s.users.includes(r)?i.value.id:null;s.usersBeingUpdated=[...s.usersBeingUpdated,{user_id:r,branch_id:e}]}},S=()=>{if(s.updateUsers.length==0){i.value=null,s.updateUsers=[],s.usersBeingUpdated=[];return}s.post(route("branches.users.update",i.value.id),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{i.value=null,s.updateUsers=[],s.usersBeingUpdated=[],P("Hecho!")}})},w=r=>{d.value=r},F=()=>{v.delete(route("branches.destroy",d.value),{preserveScroll:!0,preserveState:!0,onSuccess:()=>d.value=null})};return(r,e)=>(c(),u("div",null,[f.branches.length>0?(c(),u("div",j,[o(G),n("div",q,[o(E,null,{title:t(()=>[l(" Gestionar sucursales ")]),description:t(()=>[l(" Puedes administrar los usuarios de la sucursal, así como a sus integrantes. ")]),content:t(()=>[n("div",z,[(c(!0),u(B,null,C(f.branches,a=>(c(),u("div",{key:a.id,class:"flex items-center justify-between"},[n("div",null,k(a.name),1),n("div",H,[_.users.length>0?(c(),u("button",{key:0,class:"cursor-pointer ml-6 text-sm text-gray-400 underline",onClick:p=>y(a)}," Usuarios ",8,L)):U("",!0),n("button",{class:"cursor-pointer ml-6 text-sm text-red-500",onClick:p=>w(a)}," Eliminar ",8,I)])]))),128))])]),_:1})])])):U("",!0),n("div",null,[o(T,{show:i.value!=null,onClose:e[3]||(e[3]=a=>i.value=null)},{title:t(()=>[l(" Miembros de la sucursal ")]),content:t(()=>[n("div",J,[(c(!0),u(B,null,C(f.users,a=>(c(),u("div",{key:a.id},[n("label",K,[o(N,{onChange:e[0]||(e[0]=p=>$(p.target.value)),checked:m(s).users,"onUpdate:checked":e[1]||(e[1]=p=>m(s).users=p),value:a.id.toString()},null,8,["checked","value"]),n("span",O,k(a.name),1)])]))),128))])]),footer:t(()=>[o(x,{onClick:e[2]||(e[2]=a=>i.value=null)},{default:t(()=>[l(" Cancelar ")]),_:1}),o(A,{class:b(["ml-3",{"opacity-25":m(s).processing}]),disabled:m(s).processing,onClick:S},{default:t(()=>[l(" Guardar ")]),_:1},8,["class","disabled"])]),_:1},8,["show"]),o(V,{show:d.value!=null,onClose:e[5]||(e[5]=a=>d.value=null)},{title:t(()=>[l(" Eliminar sucursal ")]),content:t(()=>[l(" ¿Esta seguro que desea eliminar esta sucursal? ")]),footer:t(()=>[o(x,{onClick:e[4]||(e[4]=a=>d.value=null)},{default:t(()=>[l(" Cancelar ")]),_:1}),o(D,{class:b(["ml-3",{"opacity-deleteBranchForm":m(v).processing}]),disabled:m(v).processing,onClick:F},{default:t(()=>[l(" Eliminar ")]),_:1},8,["class","disabled"])]),_:1},8,["show"])])]))}};export{oe as default};
