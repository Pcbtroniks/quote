import{d as v,r as h,e as i,o as u,f as U,a as n,b as o,w as t,F as B,h as x,t as C,g as d,u as m,n as k}from"./app-CqaSUvss.js";import{_ as E}from"./ActionSection-DoD6w_hd.js";import{_ as N}from"./Checkbox-3sLp4gjp.js";import{_ as V}from"./ConfirmationModal-o9VvNKdz.js";import{_ as D}from"./DangerButton-4LE-1XbW.js";import{_ as T}from"./DialogModal-9PXB4aqN.js";import{_ as A}from"./PrimaryButton-CPquc_CB.js";import{_ as b}from"./SecondaryButton-FNk60WOg.js";import{S as G}from"./SectionBorder-DRBeil52.js";import{S as M}from"./sweetalert2.all-9phAqy9a.js";import"./SectionTitle-BETQv2W-.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Modal-CoAf4Sah.js";const P=M.mixin({toast:!0,position:"top-right",iconColor:"white",customClass:{popup:"colored-toast"},showConfirmButton:!1,timer:1500,timerProgressBar:!0}),j=(_="Success")=>P.fire({icon:"success",title:_}),q={key:0},z={class:"mt-10 sm:mt-0"},H=n("h2",{class:"font-semibold text-xl text-white leading-tight"}," Gestionar sucursales ",-1),L=n("h3",{class:"text-md text-gray-300"}," Puedes administrar los usuarios de la sucursal, así como a sus integrantes. ",-1),I={class:"space-y-6"},J={class:"flex items-center"},K=["onClick"],O=["onClick"],Q={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},R={class:"flex items-center"},W={class:"ml-2 text-sm text-gray-600"},de={__name:"BranchUserManager",props:{branches:Array,users:Array},setup(_){const f=_,s=v.useForm({users:null,updateUsers:[],usersBeingUpdated:[]}),g=v.useForm(),l=h(null),c=h(null),y=r=>{l.value=r,s.users=f.users.filter(e=>e.branch_id==r.id).map(e=>e.id)},S=r=>{if(s.updateUsers.includes(r))s.updateUsers=s.updateUsers.filter(e=>e!=r),s.usersBeingUpdated=s.usersBeingUpdated.filter(e=>e.user_id!=r);else{s.updateUsers=[...s.updateUsers,r];const e=s.users.includes(r)?l.value.id:null;s.usersBeingUpdated=[...s.usersBeingUpdated,{user_id:r,branch_id:e}]}},$=()=>{if(s.updateUsers.length==0){l.value=null,s.updateUsers=[],s.usersBeingUpdated=[];return}s.post(route("branches.users.update",l.value.id),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{l.value=null,s.updateUsers=[],s.usersBeingUpdated=[],j("Hecho!")}})},w=r=>{c.value=r},F=()=>{g.delete(route("branches.destroy",c.value),{preserveScroll:!0,preserveState:!0,onSuccess:()=>c.value=null})};return(r,e)=>(u(),i("div",null,[f.branches.length>0?(u(),i("div",q,[o(G),n("div",z,[o(E,null,{title:t(()=>[H]),description:t(()=>[L]),content:t(()=>[n("div",I,[(u(!0),i(B,null,x(f.branches,a=>(u(),i("div",{key:a.id,class:"flex items-center justify-between"},[n("div",null,C(a.name),1),n("div",J,[_.users.length>0?(u(),i("button",{key:0,class:"cursor-pointer ml-6 text-sm text-gray-400 underline",onClick:p=>y(a)}," Usuarios ",8,K)):U("",!0),n("button",{class:"cursor-pointer ml-6 text-sm text-red-500",onClick:p=>w(a)}," Eliminar ",8,O)])]))),128))])]),_:1})])])):U("",!0),n("div",null,[o(T,{show:l.value!=null,onClose:e[3]||(e[3]=a=>l.value=null)},{title:t(()=>[d(" Miembros de la sucursal ")]),content:t(()=>[n("div",Q,[(u(!0),i(B,null,x(f.users,a=>(u(),i("div",{key:a.id},[n("label",R,[o(N,{onChange:e[0]||(e[0]=p=>S(p.target.value)),checked:m(s).users,"onUpdate:checked":e[1]||(e[1]=p=>m(s).users=p),value:a.id.toString()},null,8,["checked","value"]),n("span",W,C(a.name),1)])]))),128))])]),footer:t(()=>[o(b,{onClick:e[2]||(e[2]=a=>l.value=null)},{default:t(()=>[d(" Cancelar ")]),_:1}),o(A,{class:k(["ml-3",{"opacity-25":m(s).processing}]),disabled:m(s).processing,onClick:$},{default:t(()=>[d(" Guardar ")]),_:1},8,["class","disabled"])]),_:1},8,["show"]),o(V,{show:c.value!=null,onClose:e[5]||(e[5]=a=>c.value=null)},{title:t(()=>[d(" Eliminar sucursal ")]),content:t(()=>[d(" ¿Esta seguro que desea eliminar esta sucursal? ")]),footer:t(()=>[o(b,{onClick:e[4]||(e[4]=a=>c.value=null)},{default:t(()=>[d(" Cancelar ")]),_:1}),o(D,{class:k(["ml-3",{"opacity-deleteBranchForm":m(g).processing}]),disabled:m(g).processing,onClick:F},{default:t(()=>[d(" Eliminar ")]),_:1},8,["class","disabled"])]),_:1},8,["show"])])]))}};export{de as default};
