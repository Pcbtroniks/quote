import{_ as L}from"./BodySection.eb6a5751.js";import{_ as d}from"./Button.8b37ac74.js";import{D as $,o as c,c as u,w as p,f as m,a as e,n as v,t as s,d as g,e as l,g as S,L as N,b as V,I as f,y as z}from"./app.51377cf6.js";import"./SectionTitle.8dd8a65c.js";import"./_plugin-vue_export-helper.cdc0426e.js";const A={class:"col-span-6"},T={class:"text-lg font-medium text-gray-900"},j={key:0},E={class:"text-sm text-gray-500"},O=e("br",null,null,-1),D={class:"text-sm text-gray-500"},G=e("br",null,null,-1),I={class:"text-sm text-gray-500"},P={class:"col-span-6 sm:col-span-4"},F={class:"relative flex items-center gap-1"},H={key:0,class:"mt-2"},M={key:1},Q={class:"mt-4 xl:w-[31rem] border-2 border-b-4 border-gray-200 rounded-xl hover:bg-gray-50"},R={key:0,class:"bg-sky-500 w-fit px-4 py-1 text-sm font-bold text-white rounded-tl-lg rounded-br-xl"},J={class:"grid grid-cols-6 p-5 gap-y-2"},K={class:"col-span-5 md:col-span-4 ml-4"},U=["href"],W={class:"text-sky-500 font-bold text-xs capitalize"},X={class:"text-gray-600 font-bold"},Y={class:"text-gray-400"},Z={class:"text-gray-400"},oo={class:"col-span-6 xl:col-auto flex xl:flex-col justify-between"},eo={class:"flex col-start-2 ml-4 md:col-start-auto md:ml-0 md:justify-end"},to={class:"rounded-lg text-sky-500 font-bold bg-sky-100 py-1 px-3 text-sm w-fit h-fit"},ro={__name:"CouponQuoteActions",props:{quote:Object},setup(r){const a=r,o=$({coupon:null,error:null,couponCode:null,processing:!1,syncing:!1}),q=async n=>{const t=await f.post(route("coupon.get.coupon",{quote:n}));console.log(t),Swal.fire({title:"C\xF3digo de cup\xF3n",text:t.data.code,icon:"success",confirmButtonText:"Ok"}).then(i=>{i.isConfirmed&&location.reload()})},k=async n=>{const t=await f.post(route("coupon.confirm",{coupon:n}));console.log(t),Swal.fire({title:"Cupon confirmado!",text:"El cup\xF3n ha sido confirmado y estara disponible para su uso",icon:"success",confirmButtonText:"Ok"}).then(i=>{i.isConfirmed&&location.reload()})},C=async n=>{Swal.fire({title:"\xBFEst\xE1s seguro?",text:"\xA1No podr\xE1s revertir esto!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"S\xED, \xA1aplicar cup\xF3n!"}).then(t=>{t.isConfirmed&&k(n)})},w=async(n,t)=>{if(!t)return!1;o.syncing=!0;try{const i=await f.post(route("invoices.sync.coupon",{invoice:n}),{coupon:t});o.coupon.invoice_id=n,z.Inertia.reload()}catch(i){alert("Ha ocurrido un error: "+i.message)}finally{o.syncing=!1}},B=n=>{switch(n){case"pending":return"bg-yellow-100 text-yellow-500";case"confirmed":return"bg-green-100 text-green-500";case"canceled":return"bg-red-100 text-red-500";default:return"bg-gray-100 text-gray-500"}};return(n,t)=>(c(),u(L,null,{title:p(()=>[m(" Acciones ")]),description:p(()=>[m(" Genere un folio / Muestre oculte el folio ")]),content:p(()=>{var i,_,y,x,h;return[e("div",A,[e("div",T,[m("Cotizaci\xF3n "),e("span",{class:v([B(a.quote.status),"p-2 rounded"])},"status "+s(a.quote.status),3)]),((i=a.quote.coupon)==null?void 0:i.status)!="confirmed"&&n.$page.props.user.is_freetraveler_admin?(c(),g("div",j,[e("span",E,"Realizada por: "+s(a.quote.user.name)+" en ("+s(a.quote.team.name)+") el dia "+s(a.quote.created_at),1),O,e("span",D,"Precio publico: $"+s(a.quote.public_price),1),G,e("span",I,"Costo: $"+s(a.quote.cost_amount),1)])):l("",!0)]),e("div",P,[e("div",F,[(_=r.quote.coupon)!=null&&_.code?l("",!0):(c(),u(d,{key:0,onClick:t[0]||(t[0]=b=>q(a.quote.id)),class:v({"opacity-25":o.processing}),isLoading:o.processing,msg:"Generar Folio"},null,8,["class","isLoading"])),((y=r.quote.coupon)==null?void 0:y.code)&&r.quote.coupon.status!="confirmed"?(c(),u(d,{key:1,onClick:t[1]||(t[1]=b=>C(a.quote.coupon.id)),class:"bg-green-500 hover:bg-green-600",isLoading:o.processing,disabled:r.quote.coupon.confirmation_key==null,msg:"Aceptar cupon"},null,8,["isLoading","disabled"])):l("",!0)]),((x=r.quote.coupon)==null?void 0:x.confirmation_key)==null?(c(),g("small",H," Nota: debe agregar la clave de confirmaci\xF3n para poder aceptar el cupon. ")):l("",!0),o.coupon?(c(),g("div",M,[e("div",Q,[o.coupon.quote.national!=0?(c(),g("p",R," Promomex ")):l("",!0),e("div",J,[e("div",K,[e("a",{target:"_blank",href:o.coupon.quote.url},[e("p",W,s(o.coupon.quote.team.name)+" "+s(o.coupon.quote.type)+s(o.coupon.quote.type=="paquete"?"#"+o.coupon.quote.listed_activities.length:"")+" "+s((h=o.coupon.invoice)==null?void 0:h.folio),1)],8,U),e("p",X,s(o.coupon.quote.listed_activity.activity.name),1),e("p",Y,s(o.coupon.quote.listed_activity.date),1),e("p",Z,s(o.coupon.quote.holder_name),1)]),e("div",oo,[e("div",eo,[e("p",to,"$"+s(o.coupon.sale_amount),1)]),e("div",null,[o.coupon.invoice_id?(c(),u(S(N),{key:1,href:n.route("invoices.coupons",{invoice:o.coupon.invoice_id})},{default:p(()=>[V(d,{type:"button",isLoading:o.syncing,class:"bg-amber-500 hover:bg-amber-700",msg:"Ver factura..."},null,8,["isLoading"])]),_:1},8,["href"])):(c(),u(d,{key:0,onClick:t[2]||(t[2]=b=>w(a.invoice.id,o.coupon.id)),isLoading:o.syncing,msg:"Agregar"},null,8,["isLoading"]))])])])])])):l("",!0)])]}),_:1}))}};export{ro as default};
