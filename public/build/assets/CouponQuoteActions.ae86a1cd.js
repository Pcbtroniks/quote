import{_ as B}from"./BodySection.61d2c92d.js";import{_ as d}from"./Button.2e53c532.js";import{D as L,o as a,c as l,w as p,f as g,a as e,n as v,t as i,e as u,d as m,g as S,L as N,b as $,I as f,y as V}from"./app.9645caa1.js";import"./SectionTitle.1857cba1.js";import"./_plugin-vue_export-helper.cdc0426e.js";const A={class:"col-span-6"},T={class:"text-lg font-medium text-gray-900"},j={class:"col-span-6 sm:col-span-4"},z={class:"relative flex items-center gap-1"},E={key:0,class:"mt-2"},O={key:1},D={class:"mt-4 xl:w-[31rem] border-2 border-b-4 border-gray-200 rounded-xl hover:bg-gray-50"},G={key:0,class:"bg-sky-500 w-fit px-4 py-1 text-sm font-bold text-white rounded-tl-lg rounded-br-xl"},I={class:"grid grid-cols-6 p-5 gap-y-2"},F={class:"col-span-5 md:col-span-4 ml-4"},H=["href"],M={class:"text-sky-500 font-bold text-xs capitalize"},P={class:"text-gray-600 font-bold"},Q={class:"text-gray-400"},J={class:"text-gray-400"},K={class:"col-span-6 xl:col-auto flex xl:flex-col justify-between"},R={class:"flex col-start-2 ml-4 md:col-start-auto md:ml-0 md:justify-end"},U={class:"rounded-lg text-sky-500 font-bold bg-sky-100 py-1 px-3 text-sm w-fit h-fit"},eo={__name:"CouponQuoteActions",props:{quote:Object},setup(c){const r=c,o=L({coupon:null,error:null,couponCode:null,processing:!1,syncing:!1}),b=async n=>{const t=await f.post(route("coupon.get.coupon",{quote:n}));console.log(t),Swal.fire({title:"C\xF3digo de cup\xF3n",text:t.data.code,icon:"success",confirmButtonText:"Ok"}).then(s=>{s.isConfirmed&&location.reload()})},k=async n=>{const t=await f.post(route("coupon.confirm",{coupon:n}));console.log(t),Swal.fire({title:"Cupon confirmado!",text:"El cup\xF3n ha sido confirmado y estara disponible para su uso",icon:"success",confirmButtonText:"Ok"}).then(s=>{s.isConfirmed&&location.reload()})},C=async n=>{Swal.fire({title:"\xBFEst\xE1s seguro?",text:"\xA1No podr\xE1s revertir esto!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"S\xED, \xA1aplicar cup\xF3n!"}).then(t=>{t.isConfirmed&&k(n)})},q=async(n,t)=>{if(!t)return!1;o.syncing=!0;try{const s=await f.post(route("invoices.sync.coupon",{invoice:n}),{coupon:t});o.coupon.invoice_id=n,V.Inertia.reload()}catch(s){alert("Ha ocurrido un error: "+s.message)}finally{o.syncing=!1}},w=n=>{switch(n){case"pending":return"bg-yellow-100 text-yellow-500";case"confirmed":return"bg-green-100 text-green-500";case"canceled":return"bg-red-100 text-red-500";default:return"bg-gray-100 text-gray-500"}};return(n,t)=>(a(),l(B,null,{title:p(()=>[g(" Acciones ")]),description:p(()=>[g(" Genere un folio / Muestre oculte el folio ")]),content:p(()=>{var s,y,_,x;return[e("div",A,[e("div",T,[g("Cotizaci\xF3n "),e("span",{class:v([w(r.quote.status),"p-2 rounded"])},"status "+i(r.quote.status),3)])]),e("div",j,[e("div",z,[(s=c.quote.coupon)!=null&&s.code?u("",!0):(a(),l(d,{key:0,onClick:t[0]||(t[0]=h=>b(r.quote.id)),class:v({"opacity-25":o.processing}),isLoading:o.processing,msg:"Generar Folio"},null,8,["class","isLoading"])),((y=c.quote.coupon)==null?void 0:y.code)&&c.quote.coupon.status!="confirmed"?(a(),l(d,{key:1,onClick:t[1]||(t[1]=h=>C(r.quote.coupon.id)),class:"bg-green-500 hover:bg-green-600",isLoading:o.processing,disabled:c.quote.coupon.confirmation_key==null,msg:"Aceptar cupon"},null,8,["isLoading","disabled"])):u("",!0)]),((_=c.quote.coupon)==null?void 0:_.confirmation_key)==null?(a(),m("small",E," Nota: debe agregar la clave de confirmaci\xF3n para poder aceptar el cupon. ")):u("",!0),o.coupon?(a(),m("div",O,[e("div",D,[o.coupon.quote.national!=0?(a(),m("p",G," Promomex ")):u("",!0),e("div",I,[e("div",F,[e("a",{target:"_blank",href:o.coupon.quote.url},[e("p",M,i(o.coupon.quote.team.name)+" "+i(o.coupon.quote.type)+i(o.coupon.quote.type=="paquete"?"#"+o.coupon.quote.listed_activities.length:"")+" "+i((x=o.coupon.invoice)==null?void 0:x.folio),1)],8,H),e("p",P,i(o.coupon.quote.listed_activity.activity.name),1),e("p",Q,i(o.coupon.quote.listed_activity.date),1),e("p",J,i(o.coupon.quote.holder_name),1)]),e("div",K,[e("div",R,[e("p",U,"$"+i(o.coupon.sale_amount),1)]),e("div",null,[o.coupon.invoice_id?(a(),l(S(N),{key:1,href:n.route("invoices.coupons",{invoice:o.coupon.invoice_id})},{default:p(()=>[$(d,{type:"button",isLoading:o.syncing,class:"bg-amber-500 hover:bg-amber-700",msg:"Ver factura..."},null,8,["isLoading"])]),_:1},8,["href"])):(a(),l(d,{key:0,onClick:t[2]||(t[2]=h=>q(r.invoice.id,o.coupon.id)),isLoading:o.syncing,msg:"Agregar"},null,8,["isLoading"]))])])])])])):u("",!0)])]}),_:1}))}};export{eo as default};
