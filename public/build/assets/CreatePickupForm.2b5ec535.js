import{r as f,u as V,o as i,d,a as e,n as C,g as n,b as v,l as N,v as _,M as k,F as h,h as g,E,x as $,f as A,t as y}from"./app.aa4d6a0d.js";import{_ as F}from"./InputText.dd2966b9.js";import{_ as M}from"./Button.b1dbf487.js";import{c as U,b as H,v as j,f as D,R as G}from"./Utils.91184964.js";import{B as R,S as Z}from"./Alerts.bdd657cb.js";import O from"./CreateHotelForm.f8c57876.js";import"./sweetalert2.all.fdf5f0a2.js";const W=async(r,o=null,c)=>{try{return await(await fetch(r,o)).json()}catch{alert("Error al cargar los datos, por favor recargue la pagina")}finally{c&&c()}},w=async r=>await W(route("hotels",{zone:r})),q=async(r,o={})=>r==1&&!o.cancun?(o.cancun=await w(1),o):r==1&&o.cancun?o:r==2&&!o.rm?(o.rm=await w(2),o):r==2&&o.rm?o:r==3&&!o.pdc?(o.pdc=await w(3),o):(r==3&&o.pdc,o),I={class:"w-full antialiased bg-gray-100 text-gray-600"},J={class:"flex flex-col justify-center h-full"},K={class:"w-full mx-auto bg-white shadow-lg rounded-sm"},L={class:"px-5 pt-4 py-4 pb-8 border-b border-gray-100"},Q=e("h1",{class:"font-bold text-sky-500 text-2xl border-b border-gray-100 pb-4"},[e("br",{class:"md:hidden"}),A("Creando un pickup")],-1),X=["onSubmit"],Y={class:"md:mt-8 md:flex md:gap-3 md:items-center"},ee={class:"md:w-1/6"},te=e("label",{for:"zone",class:"mb-3 block text-base font-medium text-gray-700"}," Elegir zona ",-1),oe=e("option",{value:"null",selected:"",disabled:""},"-- Zonas --",-1),se=["value","selected"],le={key:1},ae=e("div",{class:"h-4 md:hidden"},null,-1),ne={class:"md:w-2/6"},re=e("label",{for:"hotelName",class:"mb-3 block text-base font-medium text-gray-700"}," Elegir hotel ",-1),ie={class:"relative"},de={class:"w-full flex flex-col gap-2 absolute bg-white border shadow-md max-h-80 overflow-auto"},ue=["onClick"],ce=e("div",{class:"h-4 md:hidden"},null,-1),me={class:"md:w-2/6"},pe=e("label",{for:"tour",class:"mb-3 block text-base font-medium text-gray-700"}," Tour ",-1),fe=e("option",{value:"null",selected:"",disabled:""},"-- Tours --",-1),ve=["value","selected"],_e={key:1},be=e("div",{class:"h-4 md:hidden"},null,-1),he={class:"md:w-2/6"},ge=e("label",{for:"tourPickupTime",class:"mb-3 block text-base font-medium text-gray-700"}," Hora del pickup ",-1),ye={class:"mt-4"},we={type:"submit"},Be={__name:"CreatePickupForm",props:{params:Object,tours:Array},setup(r){const o=r,c=f({}),u=f([]),p=f([]),m=f(!1),s=V({zone:null,hotel:null,activity:null,pickup_time:null}),b=f({name:null}),T=a=>{if(a==null&&a.id==s.hotel){m.value=!1;return}s.hotel=a.id,b.value.name=a.name,m.value=!1},z=(a="")=>{const l=[{id:null,name:"No se encontraron hoteles"}];if(a.length==0){p.value=u.value;return}if(a.length<3)return;const t=u.value.filter(x=>x.name.toLowerCase().includes(a.toLowerCase()));t.length==0?p.value=l:p.value=t},P=()=>{setTimeout(()=>{m.value=!1},100)},B=async a=>{c.value=await q(a,c.value),u.value.pop(),u.value=c.value[U(a)],p.value=[...u.value],m.value=!0,b.value.name=""},S=async()=>{if(!j(s.pickup_time))return R();s.pickup_time=D(s.pickup_time),s.post(route("pickups.store"),{preserveScroll:!0,onSuccess:a=>{console.log(a),Z("Pickup creado exitosamente"),G()},onerror:a=>{console.log(a),alert(a)},onFinish:()=>{s.reset()}})};return(a,l)=>(i(),d("section",I,[e("div",J,[e("div",K,[e("header",L,[Q,e("div",{class:C({hidden:!n(s).zone})},[v(O,{zone:n(s).zone},null,8,["zone"])],2),e("form",{onSubmit:N(S,["prevent"]),autocomplete:"off"},[e("div",Y,[e("div",ee,[te,_(e("select",{id:"zone",onChange:l[0]||(l[0]=t=>B(t.target.value)),"onUpdate:modelValue":l[1]||(l[1]=t=>n(s).zone=t),name:"zone",class:"w-full rounded-md border border-[#e0e0e0] bg-white py-3 px-6 text-base font-medium text-[#6B7280] outline-none focus:border-[#6A64F1] focus:shadow-md"},[oe,n(H)()?(i(!0),d(h,{key:0},g(n(H)(),t=>(i(),d("option",{class:"capitalize",value:t.id,selected:o.params.zone==t.id},y(t.name),9,se))),256)):(i(),d("option",le,"no disponibles"))],544),[[k,n(s).zone]])]),ae,e("div",ne,[re,v(F,{autcomplete:"off",id:"hotelName",placeholder:"Nombre del hotel...",class:"w-full",value:b.value.name,onFocus:l[2]||(l[2]=t=>m.value=!0),onBlur:l[3]||(l[3]=t=>P()),onInput:l[4]||(l[4]=t=>z(t.target.value))},null,8,["value"]),_(e("input",{type:"hidden",name:"hotel","onUpdate:modelValue":l[5]||(l[5]=t=>n(s).hotel=t)},null,512),[[E,n(s).hotel]]),_(e("div",ie,[e("ul",de,[(i(!0),d(h,null,g(p.value,t=>(i(),d("li",{class:"hover:bg-sky-500 hover:text-white p-4 cursor-pointer",onClick:x=>T(t)},y(t.name),9,ue))),256))])],512),[[$,m.value&&u.value.length>0]])]),ce,e("div",me,[pe,_(e("select",{id:"tour","onUpdate:modelValue":l[6]||(l[6]=t=>n(s).activity=t),name:"tour",class:"w-full rounded-md border border-[#e0e0e0] bg-white py-3 px-6 text-base font-medium text-[#6B7280] outline-none focus:border-[#6A64F1] focus:shadow-md"},[fe,o.tours?(i(!0),d(h,{key:0},g(o.tours,t=>(i(),d("option",{class:"capitalize",value:t.id,selected:o.params.activity==t.id},y(t.name),9,ve))),256)):(i(),d("option",_e,"Tours no disponibles"))],512),[[k,n(s).activity]])]),be,e("div",he,[ge,v(F,{id:"tourPickupTime",placeholder:"hh:mm...",class:"w-full",modelValue:n(s).pickup_time,"onUpdate:modelValue":l[7]||(l[7]=t=>n(s).pickup_time=t)},null,8,["modelValue"])])]),e("div",ye,[e("button",we,[v(M,{msg:"Guardar",isLoading:n(s).processing},null,8,["isLoading"])])])],40,X)])])])]))}};export{Be as default};
