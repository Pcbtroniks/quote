import{r as p,D as I,o as a,d as s,a as i,q as N,b as o,w as t,f as n,t as k,P as z,n as w,I as R,u as E,i as D,k as Q,c as g,e as d,g as T,F as G,h as U,j,y as K}from"./app.bddc5148.js";import{_ as O}from"./ActionSection.247bd4a1.js";import{_ as J}from"./DialogModal.163e6d24.js";import{_ as B}from"./InputError.01986bd1.js";import{_ as P}from"./PrimaryButton.c1498d9d.js";import{_ as C}from"./SecondaryButton.d47a64a6.js";import{_ as H}from"./TextInput.9b7a364b.js";import{_ as W}from"./DangerButton.dd235471.js";import{_ as X}from"./InputLabel.3e850567.js";import"./SectionTitle.a1850b86.js";import"./_plugin-vue_export-helper.cdc0426e.js";import"./Modal.adbfb218.js";const Y={class:"mt-4"},h={__name:"ConfirmsPassword",props:{title:{type:String,default:"Confirm Password"},content:{type:String,default:"For your security, please confirm your password to continue."},button:{type:String,default:"Confirm"}},emits:["confirmed"],setup(y,{emit:x}){const l=p(!1),e=I({password:"",error:"",processing:!1}),c=p(null),v=()=>{axios.get(route("password.confirmation")).then(r=>{r.data.confirmed?x("confirmed"):(l.value=!0,setTimeout(()=>c.value.focus(),250))})},_=()=>{e.processing=!0,axios.post(route("password.confirm"),{password:e.password}).then(()=>{e.processing=!1,u(),R().then(()=>x("confirmed"))}).catch(r=>{e.processing=!1,e.error=r.response.data.errors.password[0],c.value.focus()})},u=()=>{l.value=!1,e.password="",e.error=""};return(r,m)=>(a(),s("span",null,[i("span",{onClick:v},[N(r.$slots,"default")]),o(J,{show:l.value,onClose:u},{title:t(()=>[n(k(y.title),1)]),content:t(()=>[n(k(y.content)+" ",1),i("div",Y,[o(H,{ref_key:"passwordInput",ref:c,modelValue:e.password,"onUpdate:modelValue":m[0]||(m[0]=F=>e.password=F),type:"password",class:"mt-1 block w-3/4",placeholder:"Password",onKeyup:z(_,["enter"])},null,8,["modelValue","onKeyup"]),o(B,{message:e.error,class:"mt-2"},null,8,["message"])])]),footer:t(()=>[o(C,{onClick:u},{default:t(()=>[n(" Cancel ")]),_:1}),o(P,{class:w(["ml-3",{"opacity-25":e.processing}]),disabled:e.processing,onClick:_},{default:t(()=>[n(k(y.button),1)]),_:1},8,["class","disabled"])]),_:1},8,["show"])]))}},Z={key:0,class:"text-lg font-medium text-gray-900"},ee={key:1,class:"text-lg font-medium text-gray-900"},ae={key:2,class:"text-lg font-medium text-gray-900"},te=i("div",{class:"mt-3 max-w-xl text-sm text-gray-600"},[i("p",null," Cuando la autenticaci\xF3n de dos factores est\xE1 habilitada, se le solicitar\xE1 un token seguro y aleatorio durante la autenticaci\xF3n. Puede recuperar este token de la aplicaci\xF3n Google Authenticator de su tel\xE9fono. ")],-1),se={key:3},oe={key:0},ne={class:"mt-4 max-w-xl text-sm text-gray-600"},re={key:0,class:"font-semibold"},ie={key:1},le=["innerHTML"],ce={key:0,class:"mt-4 max-w-xl text-sm text-gray-600"},de={class:"font-semibold"},ue=["innerHTML"],me={key:1,class:"mt-4"},fe={key:1},pe=i("div",{class:"mt-4 max-w-xl text-sm text-gray-600"},[i("p",{class:"font-semibold"}," Guarde estos c\xF3digos de recuperaci\xF3n en un administrador de contrase\xF1as seguro. Se pueden usar para recuperar el acceso a su cuenta si se pierde su dispositivo de autenticaci\xF3n de dos factores. ")],-1),_e={class:"grid gap-1 max-w-xl mt-4 px-4 py-4 font-mono text-sm bg-gray-100 rounded-lg"},ve={class:"mt-5"},ge={key:0},he={key:1},Ae={__name:"TwoFactorAuthenticationForm",props:{requiresConfirmation:Boolean},setup(y){const x=y,l=p(!1),e=p(!1),c=p(!1),v=p(null),_=p(null),u=p([]),r=E({code:""}),m=D(()=>{var f;return!l.value&&((f=j().props.value.user)==null?void 0:f.two_factor_enabled)});Q(m,()=>{m.value||(r.reset(),r.clearErrors())});const F=()=>{l.value=!0,K.Inertia.post("/user/two-factor-authentication",{},{preserveScroll:!0,onSuccess:()=>Promise.all([L(),M(),S()]),onFinish:()=>{l.value=!1,e.value=x.requiresConfirmation}})},L=()=>axios.get("/user/two-factor-qr-code").then(f=>{v.value=f.data.svg}),M=()=>axios.get("/user/two-factor-secret-key").then(f=>{_.value=f.data.secretKey}),S=()=>axios.get("/user/two-factor-recovery-codes").then(f=>{u.value=f.data}),$=()=>{r.post("/user/confirmed-two-factor-authentication",{errorBag:"confirmTwoFactorAuthentication",preserveScroll:!0,preserveState:!0,onSuccess:()=>{e.value=!1,v.value=null,_.value=null}})},q=()=>{axios.post("/user/two-factor-recovery-codes").then(()=>S())},V=()=>{c.value=!0,K.Inertia.delete("/user/two-factor-authentication",{preserveScroll:!0,onSuccess:()=>{c.value=!1,e.value=!1}})};return(f,A)=>(a(),g(O,null,{title:t(()=>[n(" Autenticaci\xF3n de dos factores ")]),description:t(()=>[n(" Agregue seguridad adicional a su cuenta utilizando la autenticaci\xF3n de dos factores. ")]),content:t(()=>[m.value&&!e.value?(a(),s("h3",Z," Has habilitado la autenticaci\xF3n de dos factores. ")):m.value&&e.value?(a(),s("h3",ee," Finaliza la habilitaci\xF3n de la autenticaci\xF3n de dos factores. ")):(a(),s("h3",ae," No ha habilitado la autenticaci\xF3n de dos factores. ")),te,m.value?(a(),s("div",se,[v.value?(a(),s("div",oe,[i("div",ne,[e.value?(a(),s("p",re," Para finalizar la habilitaci\xF3n de la autenticaci\xF3n de dos factores, escanee el siguiente c\xF3digo QR utilizando la aplicaci\xF3n de autenticaci\xF3n de su tel\xE9fono o ingrese la clave de configuraci\xF3n y proporcione el c\xF3digo OTP generado. ")):(a(),s("p",ie," La autenticaci\xF3n de dos factores ahora est\xE1 habilitada. Escanee el siguiente c\xF3digo QR utilizando la aplicaci\xF3n de autenticaci\xF3n de su tel\xE9fono o ingrese la clave de configuraci\xF3n. "))]),i("div",{class:"mt-4",innerHTML:v.value},null,8,le),_.value?(a(),s("div",ce,[i("p",de,[n(" Clave: "),i("span",{innerHTML:_.value},null,8,ue)])])):d("",!0),e.value?(a(),s("div",me,[o(X,{for:"code",value:"Code"}),o(H,{id:"code",modelValue:T(r).code,"onUpdate:modelValue":A[0]||(A[0]=b=>T(r).code=b),type:"text",name:"code",class:"block mt-1 w-1/2",inputmode:"numeric",autofocus:"",autocomplete:"one-time-code",onKeyup:z($,["enter"])},null,8,["modelValue","onKeyup"]),o(B,{message:T(r).errors.code,class:"mt-2"},null,8,["message"])])):d("",!0)])):d("",!0),u.value.length>0&&!e.value?(a(),s("div",fe,[pe,i("div",_e,[(a(!0),s(G,null,U(u.value,b=>(a(),s("div",{key:b},k(b),1))),128))])])):d("",!0)])):d("",!0),i("div",ve,[m.value?(a(),s("div",he,[o(h,{onConfirmed:$},{default:t(()=>[e.value?(a(),g(P,{key:0,type:"button",class:w(["mr-3",{"opacity-25":l.value}]),disabled:l.value},{default:t(()=>[n(" Confirmar ")]),_:1},8,["class","disabled"])):d("",!0)]),_:1}),o(h,{onConfirmed:q},{default:t(()=>[u.value.length>0&&!e.value?(a(),g(C,{key:0,class:"mr-3"},{default:t(()=>[n(" Regenerar c\xF3digos de recuperaci\xF3n ")]),_:1})):d("",!0)]),_:1}),o(h,{onConfirmed:S},{default:t(()=>[u.value.length===0&&!e.value?(a(),g(C,{key:0,class:"mr-3"},{default:t(()=>[n(" Mostrar c\xF3digos de recuperaci\xF3n ")]),_:1})):d("",!0)]),_:1}),o(h,{onConfirmed:V},{default:t(()=>[e.value?(a(),g(C,{key:0,class:w({"opacity-25":c.value}),disabled:c.value},{default:t(()=>[n(" Cancelar ")]),_:1},8,["class","disabled"])):d("",!0)]),_:1}),o(h,{onConfirmed:V},{default:t(()=>[e.value?d("",!0):(a(),g(W,{key:0,class:w({"opacity-25":c.value}),disabled:c.value},{default:t(()=>[n(" Desabilitar ")]),_:1},8,["class","disabled"]))]),_:1})])):(a(),s("div",ge,[o(h,{onConfirmed:F},{default:t(()=>[o(P,{type:"button",class:w({"opacity-25":l.value}),disabled:l.value},{default:t(()=>[n(" Habilitar ")]),_:1},8,["class","disabled"])]),_:1})]))])]),_:1}))}};export{Ae as default};
